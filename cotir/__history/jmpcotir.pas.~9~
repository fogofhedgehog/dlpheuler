unit jmpcotir;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, NiApiLib_TLB, connect;

//type NIsession=class
//public
//  session: Tsrvrsession;
//  //creation
//  constructor create;
//  destructor destroy; override;
//  //methods
//  procedure connect;
//  procedure disconnect;
//  //events
//end;


type
  TForm1 = class(TForm)
    ConnectButton: TButton;
    ConnectLabel: TLabel;
    procedure ConnectButtonClick(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;
  conct: NIsession;

implementation

{$R *.dfm}

procedure TForm1.ConnectButtonClick(Sender: TObject);
begin
  if ConnectButton.Caption = 'Connect'
  then
  begin
    conct:= Nis;
    Form2.ShowModal;
    Form1.Show;
    if logres = 1 then
    begin
      ConnectLabel.Caption:= 'Connected';
      ConnectLabel.Font.Color:= clGreen;
      ConnectButton.Caption:= 'Disconnect'
    end
  end
  else
  begin
    ConnectButton.Caption:= 'Connect';
    conct.disconnect
  end;

end;

end.
